Precip_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
Precip_intervals <- bind_rows(Precip_intervals, final)
}
tz(Precip_intervals$datetime_EST)
ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" )
ppt2
Precip_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
Precip_intervals <- bind_rows(Precip_intervals, final)
}
tz(Precip_intervals$datetime_EST)
rlang::last_error()
?rbind
Precip_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
Precip_intervals <- vctrs::vec_rbind(Precip_intervals, final)
}
tz(Precip_intervals$datetime_EST)
Precip_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
mutate(ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" ))
Precip_intervals <- vctrs::vec_rbind(Precip_intervals, final)
}
tz(Precip_intervals$datetime_EST)
Precip_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
mutate(ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" ))
Precip_intervals <- bind_rows(Precip_intervals, final)
}
tz(Precip_intervals$datetime_EST)
Precip_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
mutate(ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" ))
Precip_intervals <- bind_rows(Precip_intervals, final)
}
tz(Precip_intervals$datetime_EST)
Precip_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
mutate(ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" ))
Precip_intervals <- bind_rows(Precip_intervals, final)
}
tz(Precip_intervals$datetime_EST)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
mutate(datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" ))
Precip_intervals <- bind_rows(Precip_intervals, final)
}
tz(ppt_intervals$datetime_EST)
?bind_rows
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
mutate()
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
final <- ppt2
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
rlang::last_error()
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
vec <- c(0, NA)
vec
ppt2 <- ppt[! ppt$W9_Precipitation_mm %in% vec,]
View(ppt2)
ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" )
ppt2
#adding duration in seconds
ppt2 <- ppt2 %>%
mutate(Time <- hour(ppt2$datetime_EST) + minute(ppt2$datetime_EST)/60 + second(ppt2$datetime_EST)/3600)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
length(intervals)
intervals
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
mutate(Rate = W9_Precipitation_mm/Time) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
mutate(Rate = W9_Precipitation_mm/Time)
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
group_by(W9_Precipitation_mm) %>%
mutate(Rate = W9_Precipitation_mm/Time) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt, 0)
ppt_intervals<- as.POSIXct(ppt_intervals, format = "%m/%d/%Y %H:%M" )
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
group_by(W9_Precipitation_mm) %>%
mutate(Rate = W9_Precipitation_mm/Time) %>%
ppt_intervals <- bind_rows(as.POSIXct(ppt_intervals, format = "%m/%d/%Y %H:%M" ), final)
}
tz(ppt_intervals$datetime_EST)
ppt2 <- ppt2 %>%
mutate(Time <- hour(ppt2$datetime_EST) + minute(ppt2$datetime_EST)/60 + second(ppt2$datetime_EST)/3600)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
group_by(W9_Precipitation_mm) %>%
mutate(Rate = W9_Precipitation_mm/Time) %>%
ppt_intervals <- bind_rows(as.POSIXct(ppt_intervals, format = "%m/%d/%Y %H:%M" ), final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
group_by(W9_Precipitation_mm) %>%
mutate(Rate = W9_Precipitation_mm/Time) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
View(Precip_intervals)
View(ppt_intervals)
library(dplyr)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(ppt2$datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(ppt2$datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(ppt2$datetime_EST %within% intervals) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals)[i] %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(datetime_EST %within% events2$datetime_interval_EST2[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(ppt$datetime_EST %within% events2$datetime_interval_EST2[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(ppt2$datetime_EST %within% events2$datetime_interval_EST2[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
#filtering intervals
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter('*tmp* = 1', ppt2$datetime_EST %within% events2$datetime_interval_EST2[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(*tmp* = 1, ppt2$datetime_EST %within% events2$datetime_interval_EST2[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
#filtering intervals
ppt_intervals <- slice(ppt2, 0)
tmp=1
rm(tmp)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter( ppt2$datetime_EST %within% events2$datetime_interval_EST2[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
tmp=1
rm(tmp)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(unique(datetime_EST) %within% events2$datetime_interval_EST2[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
interval <- unique(ppt2$datetime_EST)
interval
ppt_intervals <- slice(ppt2, 0)
interval <- unique(ppt2$datetime_EST)
interval
tmp=1
rm(tmp)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(interval %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i]) %>%
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
library(tidyverse) #this is a set of several packages including 'readr'
library(here)
here <- here() #create a filepath object named "here" to use later
library(lubridate) #lubridate needs to be loaded separately
events <- readr::read_csv(paste0(here, "/data/W9_Throughfall_Stemflow_Precipitation.csv"))
ppt <- readr::read_csv(paste0(here, "/data/W9_Streamflow_Precipitation.csv"))
events2 <- events %>%
mutate(.after = datetime_end_GMT, #indicates where the new column is placed
datetime_interval_EST2 = lubridate::interval(start = datetime_start_GMT,
end = datetime_end_GMT,
tz = "EST"))
class(events2$datetime_interval_EST2)
tz(events2$datetime_interval_EST2) #timezone of interval gives an error
tz(events2$datetime_start_GMT) #timezone of start is UTC/GMT
view(events2) #check the new intervals match the character intervals
intervals <- unique(events2$datetime_interval_EST2)
intervals
vec <- c(0, NA)
vec
ppt2 <- ppt[! ppt$W9_Precipitation_mm %in% vec,]
View(ppt2)
ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M" )
ppt2
ppt2 <- ppt2 %>%
mutate(Time <- hour(ppt2$datetime_EST) + minute(ppt2$datetime_EST)/60 + second(ppt2$datetime_EST)/3600)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt2$datetime_EST <- as.POSIXct(ppt2$datetime_EST, format = "%m/%d/%Y %H:%M", tz = "EST" )
ppt2 <- ppt2 %>%
mutate(Time <- hour(ppt2$datetime_EST) + minute(ppt2$datetime_EST)/60 + second(ppt2$datetime_EST)/3600)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(events2$datetime_interval_EST2)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt2, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt2 %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
start <- int_start(events2$datetime_interval_EST2[1])
class(start)
tz(start)
startppt <- int_start(ppt2$datetime_EST[1])
class(startppt)
tz(startppt)
start <- int_start(ppt2$datetime_EST[1])
class(start)
tz(start)
vec <- c(0, NA)
vec
ppt <- ppt[! ppt$W9_Precipitation_mm %in% vec,]
vec <- c(0, NA)
vec
ppt <- ppt[! ppt$W9_Precipitation_mm %in% vec,]
View(ppt)
ppt$datetime_EST <- as.POSIXct(ppt$datetime_EST, format = "%m/%d/%Y %H:%M", tz = "EST" )
ppt
ppt <- ppt %>%
mutate(Time <- hour(ppt2$datetime_EST) + minute(ppt2$datetime_EST)/60 + second(ppt2$datetime_EST)/3600)
filtering intervals
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
ppt_intervals <- slice(ppt, 0)
i=1
rm(i)
for (i in 1:length(intervals)) {
final <- ppt %>%
filter(datetime_EST %within% intervals[i]) %>%
mutate(Event_number = events2$Event_Number[i])
ppt_intervals <- bind_rows(ppt_intervals, final)
}
tz(ppt_intervals$datetime_EST)
