saveRDS(hobo_events4, paste0(here, "/output/hobo_events_summary.Rds"))
View(hobo_event_summary)
anova_yield <- aov(event_yld_mm ~ site, data = nested_data)
anova_yield <- aov(event_yld_mm ~ site, data = hobo_event_summary)
summary(anova_yield)
anova_yield <- aov(event_yld_mm ~ site + hobo_event_n, data = hobo_event_summary)
summary(anova_yield)
anova_yield <- aov(event_yld_mm ~ site + as.char(hobo_event_n), data = hobo_event_summary)
anova_yield <- aov(event_yld_mm ~ site + as.character(hobo_event_n), data = hobo_event_summary)
summary(anova_yield)
anova_yield <- aov(max_rate_mm_5_min ~ site + as.character(hobo_event_n), data = hobo_event_summary)
anova_yield <- aov(max_rate_mm_5min ~ site + as.character(hobo_event_n), data = hobo_event_summary)
summary(anova_max_rate)
anova_max_rate <- aov(max_rate_mm_5min ~ site + as.character(hobo_event_n), data = hobo_event_summary)
summary(anova_max_rate)
anova_mean_rate <- aov(mean_rate_mm_5min ~ site + as.character(hobo_event_n), data = hobo_event_summary)
summary(anova_mean_rate)
View(hobo_events2)
View(hobo_event_summary)
anova_cumyield <- aov(event_yld_mm ~ site + as.character(hobo_event_n), data = hobo_event_summary)
summary(anova_cumyield)
anova_max_rate <- aov(max_rate_mm_5min ~ site + as.character(hobo_event_n), data = hobo_event_summary)
summary(anova_max_rate)
anova_mean_rate <- aov(mean_rate_mm_5min ~ site + as.character(hobo_event_n), data = hobo_event_summary)
summary(anova_mean_rate)
anova_event <- aov(m ~ as.character(hobo_event_n), data = nested_data)
summary(anova_event)
anova_site <- aov(m ~ site, data = nested_data)
summary(anova_site)
anova_flowpath <- aov(m ~ flowpath, data = flow_path)
summary(anova_flowpath )
anova_tree <- aov(m ~ Trees, data = tree_species)
summary(anova_flowpath )
anova_tree <- aov(m ~ Trees, data = tree_species)
summary(anova_flowpath )
anova_tree <- aov(m ~ Trees, data = tree_species)
summary(anova_tree)
anova_site <- aov(m ~ site, data = nested_data)
summary(anova_site)
anova_site <- aov(m ~ site, data = nd)
summary(anova_site)
anova_event <- aov(m ~ as.character(hobo_event_n), data = nd)
summary(anova_event)
anova_flowpath <- aov(m ~ flowpath, data = flow_path)
summary(anova_flowpath )
#Tree_Species----
tree_species  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC") , names_to = "Sugar",
values_to = "Sugar_Maple_mm")%>%
pivot_longer(cols = c("SFB","SFD") , names_to = "Yellow",
values_to = "Yellow_Birch_mm")%>%
select(hobo_event_n,dt, time2, Sugar_Maple_mm, Yellow_Birch_mm, log_yield)%>%
pivot_longer(cols = c("Sugar_Maple_mm","Yellow_Birch_mm") , names_to = "Trees",
values_to = "yield_mm")%>%
na.omit()%>%
group_by(Trees, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
unnest(data)
#Tree_Species----
tree_species  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC") , names_to = "Sugar",
values_to = "Sugar_Maple_mm")%>%
pivot_longer(cols = c("SFB","SFD") , names_to = "Yellow",
values_to = "Yellow_Birch_mm")%>%
select(hobo_event_n,dt, time2, Sugar_Maple_mm, Yellow_Birch_mm, log_yield)%>%
pivot_longer(cols = c("Sugar_Maple_mm","Yellow_Birch_mm") , names_to = "Trees",
values_to = "yield_mm")%>%
na.omit()%>%
group_by(Trees, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)
tree_species  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC") , names_to = "Sugar",
values_to = "Sugar_Maple_mm")%>%
pivot_longer(cols = c("SFB","SFD") , names_to = "Yellow",
values_to = "Yellow_Birch_mm")%>%
select(hobo_event_n,dt, time2, Sugar_Maple_mm, Yellow_Birch_mm, log_yield)%>%
pivot_longer(cols = c("Sugar_Maple_mm","Yellow_Birch_mm") , names_to = "Trees",
values_to = "yield_mm")
tree_species  <- hobo_events5
pivot_wider(names_from = "site", values_from = "yield_mm")
flow_path  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC", "SFB","SFD") ,
names_to = "Stem", values_to = "Stemflow_mm")%>%
pivot_longer(cols = c("TFB","TFD") , names_to = "Through",
values_to = "Throughfall_mm")%>%
select(hobo_event_n,dt, time2, Stemflow_mm, Throughfall_mm, log_yield)%>%
pivot_longer(cols = c("Stemflow_mm","Throughfall_mm") , names_to = "flowpath",
values_to = "yield_mm")%>%
na.omit()%>%
distinct(across(log_yield), .keep_all = TRUE)%>%
group_by(flowpath, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
#group_by(flow_path,hobo_event_n)%>%
unnest(data)
anova_event <- aov(m ~ hobo_event_n, data = nd)
summary(anova_event)
x ="Events", y = "r")
#Flowpath----
flow_path  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC", "SFB","SFD") ,
names_to = "Stem", values_to = "Stemflow_mm")%>%
pivot_longer(cols = c("TFB","TFD") , names_to = "Through",
values_to = "Throughfall_mm")%>%
select(hobo_event_n,dt, time2, Stemflow_mm, Throughfall_mm, log_yield)%>%
pivot_longer(cols = c("Stemflow_mm","Throughfall_mm") , names_to = "flowpath",
values_to = "yield_mm")%>%
na.omit()%>%
distinct(across(log_yield), .keep_all = TRUE)%>%
group_by(flowpath, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
#group_by(flow_path,hobo_event_n)%>%
unnest(data)
library(here)
here <- here()
here
library(tidyverse)
library(lubridate)
library(dygraphs)
library(xts)
library(ggplot2)
library(ggpubr)
library(broom)
library(AICcmodavg)
hobo_events<- readRDS(paste0(here, "/output/hobo_events.Rds"))
#Calculating max
hobo_max <- hobo_events%>%
group_by(site, hobo_event_n) %>%
summarise(max_yld_mm = max(yield_mm, na.rm=T))
#Join the max rate with the time series to access the time of max for each event
hobo_events2 <- inner_join(hobo_max, hobo_events,
by = c("site", "hobo_event_n")) %>%
rownames_to_column()
#manually keep the max yield rows
hobo_events3 <- hobo_events2 %>%
mutate(to_keep1 = case_when(yield_mm < max_yld_mm ~ FALSE,
TRUE ~ TRUE )) %>%
filter(to_keep1) %>% select(-c( to_keep1,rowname)) %>%
rename("dt_max_yield_mm" = "dt")%>%
select(-c(yield_mm))
hobo_events4 <- hobo_events %>%
left_join(., hobo_events3,
by = c("site", "hobo_event_n")) %>%
group_by(site) %>%
mutate(limb = case_when(dt < dt_max_yield_mm ~ "rising",
dt > dt_max_yield_mm ~ "falling",
dt== dt_max_yield_mm ~ "peak"))
hobo_events5 <- hobo_events4%>%
filter(limb == "falling") %>%
group_by( site)%>%
mutate(time =  seconds((dt - dt_max_yield_mm)*60),
time2 = time_length(time, unit = "seconds"))%>%
mutate(log_yield = log(yield_mm))
nested_data <- hobo_events5 %>%
group_by(site, hobo_event_n) %>%
nest() %>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
rename(hobo_data = data)%>%
rownames_to_column()
nd <-nested_data%>%
unnest(hobo_data)%>%
# select(time2,log_yield, site, hobo_event_n)%>%
group_by(site, hobo_event_n)
ggplot(nd) +
geom_line(mapping = aes(x=time2, y =log_yield, group = site, colour = site)) +
facet_wrap(~ hobo_event_n, scales = "free")+
labs(title="Log-linear Models",
x ="Time (s)", y = "Log Yield (mm)")
#Collectors----
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = site, colour = site)) +
labs(title="Model Slopes among Collectors",
x ="Events", y = "slope(m)")
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = site, colour = site)) +
labs(title="r among Collectors",
x ="Events", y = "r")
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = site, colour = site)) +
labs(title="Intercepts among Collectors",
x ="Events", y = "Intercept(i)")
#Tree_Species----
tree_species  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC") , names_to = "Sugar",
values_to = "Sugar_Maple_mm")%>%
pivot_longer(cols = c("SFB","SFD") , names_to = "Yellow",
values_to = "Yellow_Birch_mm")%>%
select(hobo_event_n,dt, time2, Sugar_Maple_mm, Yellow_Birch_mm, log_yield)%>%
pivot_longer(cols = c("Sugar_Maple_mm","Yellow_Birch_mm") , names_to = "Trees",
values_to = "yield_mm")%>%
na.omit()%>%
group_by(Trees, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
unnest(data)
ggplot(tree_species)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = Trees, colour = Trees))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = Trees, colour = Trees)) +
labs(title="Model Slopes between Tree Species",
x ="Events", y = "slope(m)")
ggplot(tree_species)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = Trees, colour = Trees))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = Trees, colour = Trees)) +
labs(title="r between Tree Species",
x ="Events", y = "r")
ggplot(tree_species)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = Trees, colour = Trees))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = Trees, colour = Trees)) +
labs(title="Intercepts between Tree Species",
x ="Events", y = "r")
#Flowpath----
flow_path  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC", "SFB","SFD") ,
names_to = "Stem", values_to = "Stemflow_mm")%>%
pivot_longer(cols = c("TFB","TFD") , names_to = "Through",
values_to = "Throughfall_mm")%>%
select(hobo_event_n,dt, time2, Stemflow_mm, Throughfall_mm, log_yield)%>%
pivot_longer(cols = c("Stemflow_mm","Throughfall_mm") , names_to = "flowpath",
values_to = "yield_mm")%>%
na.omit()%>%
distinct(across(log_yield), .keep_all = TRUE)%>%
group_by(flowpath, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
#group_by(flow_path,hobo_event_n)%>%
unnest(data)
ggplot(flow_path)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = flowpath, colour = flowpath))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = flowpath, colour = flowpath)) +
labs(title="Model Slopes between Flowpaths",
x ="Events", y = "slope(m)")
ggplot(flow_path)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = flowpath, colour = flowpath))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = flowpath, colour = flowpath))+
labs(title="R between Flowpaths",
x ="Events", y = "r")
ggplot(flow_path)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = flowpath, colour = flowpath))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = flowpath, colour = flowpath))+
labs(title="Interval values between Flowpaths",
x ="Events", y = "i")
anova_site <- aov(m ~ site, data = nd)
summary(anova_site)
anova_event <- aov(m ~ hobo_event_n, data = nd)
summary(anova_event)
anova_flowpath <- aov(m ~ flowpath, data = flow_path)
summary(anova_flowpath )
anova_tree <- aov(m ~ Trees, data = tree_species)
summary(anova_tree)
anova_site <- aov(m ~ site, data = nd)
summary(anova_site)
anova_event <- aov(m ~ as.character(hobo_event_n), data = nd)
summary(anova_event)
anova_flowpath <- aov(m ~ flowpath, data = flow_path)
summary(anova_flowpath )
anova_tree <- aov(m ~ Trees, data = tree_species)
summary(anova_tree)
library(here)
here <- here()
here
library(tidyverse)
library(lubridate)
library(dygraphs)
library(xts)
library(ggplot2)
library(ggpubr)
library(broom)
library(AICcmodavg)
hobo_events<- readRDS(paste0(here, "/output/hobo_events.Rds"))
#Calculating max
hobo_max <- hobo_events%>%
group_by(site, hobo_event_n) %>%
summarise(max_yld_mm = max(yield_mm, na.rm=T))
#Join the max rate with the time series to access the time of max for each event
hobo_events2 <- inner_join(hobo_max, hobo_events,
by = c("site", "hobo_event_n")) %>%
rownames_to_column()
#manually keep the max yield rows
hobo_events3 <- hobo_events2 %>%
mutate(to_keep1 = case_when(yield_mm < max_yld_mm ~ FALSE,
TRUE ~ TRUE )) %>%
filter(to_keep1) %>% select(-c( to_keep1,rowname)) %>%
rename("dt_max_yield_mm" = "dt")%>%
select(-c(yield_mm))
hobo_events4 <- hobo_events %>%
left_join(., hobo_events3,
by = c("site", "hobo_event_n")) %>%
group_by(site) %>%
mutate(limb = case_when(dt < dt_max_yield_mm ~ "rising",
dt > dt_max_yield_mm ~ "falling",
dt== dt_max_yield_mm ~ "peak"))
hobo_events5 <- hobo_events4%>%
filter(limb == "falling") %>%
group_by( site)%>%
mutate(time =  seconds((dt - dt_max_yield_mm)*60),
time2 = time_length(time, unit = "seconds"))%>%
mutate(log_yield = log(yield_mm))
nested_data <- hobo_events5 %>%
group_by(site, hobo_event_n) %>%
nest() %>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
rename(hobo_data = data)%>%
rownames_to_column()
nd <-nested_data%>%
unnest(hobo_data)%>%
# select(time2,log_yield, site, hobo_event_n)%>%
group_by(site, hobo_event_n)
ggplot(nd) +
geom_line(mapping = aes(x=time2, y =log_yield, group = site, colour = site)) +
facet_wrap(~ hobo_event_n, scales = "free")+
labs(title="Log-linear Models",
x ="Time (s)", y = "Log Yield (mm)")
#Collectors----
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = site, colour = site)) +
labs(title="Model Slopes among Collectors",
x ="Events", y = "slope(m)")
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = site, colour = site)) +
labs(title="r among Collectors",
x ="Events", y = "r")
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = site, colour = site)) +
labs(title="Intercepts among Collectors",
x ="Events", y = "Intercept(i)")
#Tree_Species----
tree_species  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC") , names_to = "Sugar",
values_to = "Sugar_Maple_mm")%>%
pivot_longer(cols = c("SFB","SFD") , names_to = "Yellow",
values_to = "Yellow_Birch_mm")%>%
select(hobo_event_n,dt, time2, Sugar_Maple_mm, Yellow_Birch_mm, log_yield)%>%
pivot_longer(cols = c("Sugar_Maple_mm","Yellow_Birch_mm") , names_to = "Trees",
values_to = "yield_mm")%>%
na.omit()%>%
group_by(Trees, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
unnest(data)
ggplot(tree_species)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = Trees, colour = Trees))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = Trees, colour = Trees)) +
labs(title="Model Slopes between Tree Species",
x ="Events", y = "slope(m)")
ggplot(tree_species)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = Trees, colour = Trees))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = Trees, colour = Trees)) +
labs(title="r between Tree Species",
x ="Events", y = "r")
ggplot(tree_species)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = Trees, colour = Trees))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = Trees, colour = Trees)) +
labs(title="Intercepts between Tree Species",
x ="Events", y = "r")
#Flowpath----
flow_path  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC", "SFB","SFD") ,
names_to = "Stem", values_to = "Stemflow_mm")%>%
pivot_longer(cols = c("TFB","TFD") , names_to = "Through",
values_to = "Throughfall_mm")%>%
select(hobo_event_n,dt, time2, Stemflow_mm, Throughfall_mm, log_yield)%>%
pivot_longer(cols = c("Stemflow_mm","Throughfall_mm") , names_to = "flowpath",
values_to = "yield_mm")%>%
na.omit()%>%
distinct(across(log_yield), .keep_all = TRUE)%>%
group_by(flowpath, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)%>%
#group_by(flow_path,hobo_event_n)%>%
unnest(data)
ggplot(flow_path)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = flowpath, colour = flowpath))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = flowpath, colour = flowpath)) +
labs(title="Model Slopes between Flowpaths",
x ="Events", y = "slope(m)")
ggplot(flow_path)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = flowpath, colour = flowpath))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = flowpath, colour = flowpath))+
labs(title="R between Flowpaths",
x ="Events", y = "r")
ggplot(flow_path)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = flowpath, colour = flowpath))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = flowpath, colour = flowpath))+
labs(title="Interval values between Flowpaths",
x ="Events", y = "i")
anova_site <- aov(m ~ site, data = nd)
summary(anova_site)
anova_event <- aov(m ~ as.character(hobo_event_n), data = nd)
summary(anova_event)
anova_flowpath <- aov(m ~ flowpath, data = flow_path)
summary(anova_flowpath )
anova_tree <- aov(m ~ Trees, data = tree_species)
summary(anova_tree)
#Collectors----
ggplot(nd)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = site, colour = site)) +
labs(title="Model Slopes among Collectors",
x ="Events", y = "slope(m)")
ggplot(nd)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = site, colour = site)) +
labs(title="r among Collectors",
x ="Events", y = "r")
ggplot(nd)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = site, colour = site)) +
labs(title="Intercepts among Collectors",
x ="Events", y = "Intercept(i)")
#Collectors----
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =m , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =m, group = site, colour = site)) +
labs(title="Model Slopes among Collectors",
x ="Events", y = "slope(m)")
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =r , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =r, group = site, colour = site)) +
labs(title="r among Collectors",
x ="Events", y = "r")
ggplot(nested_data)+
geom_jitter(aes(x=factor(hobo_event_n), y =i , group = site, colour = site))+
geom_boxplot(aes(x=factor(hobo_event_n), y =i, group = site, colour = site)) +
labs(title="Intercepts among Collectors",
x ="Events", y = "Intercept(i)")
#Tree_Species----
tree_species  <- hobo_events5 %>%
pivot_wider(names_from = "site", values_from = "yield_mm")%>%
pivot_longer(cols = c("SFA","SFC") , names_to = "Sugar",
values_to = "Sugar_Maple_mm")%>%
pivot_longer(cols = c("SFB","SFD") , names_to = "Yellow",
values_to = "Yellow_Birch_mm")%>%
select(hobo_event_n,dt, time2, Sugar_Maple_mm, Yellow_Birch_mm, log_yield)%>%
pivot_longer(cols = c("Sugar_Maple_mm","Yellow_Birch_mm") , names_to = "Trees",
values_to = "yield_mm")%>%
na.omit()%>%
group_by(Trees, hobo_event_n)%>%
nest()%>%
mutate(nobs = map_dbl(.x = data, .f = ~nrow(.x))) %>%
mutate(r = map_dbl(.x = data, .f = ~cor(y=.x$log_yield, x = .x$time2,
use = "na.or.complete")),
m = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[2]]),
i = map_dbl(data, ~lm(log_yield ~ time2, data = .)$coefficients[[1]]),
r2 = r^2)
